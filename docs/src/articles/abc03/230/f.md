---
title: "ABC #230 F"
url: https://atcoder.jp/contests/abc230/tasks/abc230_f
---
$A$ の累積和を $B$ とする.

$A$ から操作を繰り返して得られる数列を $C$ として, $C$ の累積和を $D$ とする. $D$ は $B$ の部分列であり, $C$ と $D$ は1対1に対応するので, $D$ の個数を数える問題となる. (ただし, $B_N$ は必ず使う)

$dp[i]$ を $B$ の $i$ 番目まで見たときに $B_i$ を使うという条件のもとでできる部分列の個数とする. このとき,

$$
dp[i] = \sum_{j=1}^{i-1} dp[j]
$$

となる. ただし, $B_k = B_j \ (k \lt j \lt i)$ となる $k$ については重複して数え上げないように加算しない.

これを計算は, $i$ 番目までに出てくる $B_j$ についての $dp[j]$ と $dp[j]$ の合計をメモしておき, $dp[i]$ の計算後にメモを更新するやり方で行う.
